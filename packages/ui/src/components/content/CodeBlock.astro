---
export interface Props {
  code: string;
  lang?: string;
  title?: string;
  showLineNumbers?: boolean;
}

const { code, lang = 'plaintext', title, showLineNumbers = false } = Astro.props;
---

<div class="code-block my-6">
  {
    title && (
      <div class="bg-surface-alt border border-border border-b-0 rounded-t-lg px-4 py-2 text-sm font-mono text-text-muted flex items-center justify-between">
        <span>{title}</span>
        <span class="text-xs">{lang}</span>
      </div>
    )
  }
  <div class="relative group">
    <pre
      class:list={[
        'bg-surface-alt border border-border p-4 overflow-x-auto text-sm font-mono',
        title ? 'rounded-b-lg' : 'rounded-lg',
      ]}
      class:has-line-numbers={showLineNumbers}><code class={`language-${lang}`}>{code}</code></pre>
    <button
      type="button"
      class="absolute top-2 right-2 btn btn-ghost p-2 opacity-0 group-hover:opacity-100 transition-opacity"
      data-copy-button
      aria-label="Copy code"
    >
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
        ></path>
      </svg>
    </button>
  </div>
</div>

<script>
  import { initCopyButtons } from '../../scripts/copy-code';
  initCopyButtons();
</script>
